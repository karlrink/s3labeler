
cool.  this is working now...

ðŸ§¨ karl.rink@Karl-MacBook-Pro t % curl "http://127.0.0.1:8880/s3/ninfo-property-images/2eece964b6f902124052810e5a92d6f9ca715c1b.jpg?tags=rekognition"
{
    "Labels": [
        {
            "Name": "Tree",
            "Confidence": 90.44393920898438,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Plant"
                }
            ]
        },
        {
            "Name": "Plant",
            "Confidence": 90.44393920898438,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Urban",
            "Confidence": 85.79068756103516,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Building",
            "Confidence": 74.22905731201172,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Flagstone",
            "Confidence": 72.1240005493164,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Vegetation",
            "Confidence": 71.17005920410156,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Plant"
                }
            ]
        },
        {
            "Name": "Garage",
            "Confidence": 66.02606964111328,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Housing",
            "Confidence": 65.3967056274414,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Building"
                }
            ]
        },
        {
            "Name": "Tarmac",
            "Confidence": 64.69490814208984,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Asphalt",
            "Confidence": 64.69490814208984,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Home Decor",
            "Confidence": 62.33171081542969,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Walkway",
            "Confidence": 58.68953323364258,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Path"
                }
            ]
        },
        {
            "Name": "Path",
            "Confidence": 58.68953323364258,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Suburb",
            "Confidence": 57.164859771728516,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Urban"
                },
                {
                    "Name": "Building"
                }
            ]
        },
        {
            "Name": "Bush",
            "Confidence": 56.60989761352539,
            "Instances": [],
            "Parents": [
                {
                    "Name": "Vegetation"
                },
                {
                    "Name": "Plant"
                }
            ]
        },
        {
            "Name": "Slate",
            "Confidence": 56.16239547729492,
            "Instances": [],
            "Parents": []
        },
        {
            "Name": "Concrete",
            "Confidence": 55.33432388305664,
            "Instances": [],
            "Parents": []
        }
    ],
    "LabelModelVersion": "2.0"
}
ðŸ§¨ karl.rink@Karl-MacBook-Pro t %



DEV.TEST
127.0.0.1 - - [22/Jul/2021 16:24:26] "GET /s3/ninfo-property-images/2eece964b6f902124052810e5a92d6f9ca715c1b.jpg?tags=rekognition HTTP/1.1" 200 -
127.0.0.1 - - [22/Jul/2021 16:24:46] "GET /s3/ninfo-property-images/ HTTP/1.1" 200 -
rekognition json
[2021-07-22 16:25:07,480] ERROR in app: Exception on /s3/ninfo-property-images/000023d448b50c23836ac0ea4e699287aa4ce707.jpg [GET]
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 2446, in wsgi_app
    response = self.full_dispatch_request()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1951, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1820, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/_compat.py", line 39, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1949, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1935, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "./s3imglbr.py", line 97, in get_s3bucketobject
    rekognition_json_content = get_rekognition_json(s3bucket, s3object)
  File "./s3imglbr.py", line 264, in get_rekognition_json
    return get_s3object_body(s3bucket, rekognition_json_file)
  File "./s3imglbr.py", line 270, in get_s3object_body
    body = obj.get()['Body'].read()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/boto3/resources/factory.py", line 520, in do_action
    response = action(self, *args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/boto3/resources/action.py", line 83, in __call__
    response = getattr(parent.meta.client, operation_name)(*args, **params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/client.py", line 386, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/client.py", line 705, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.NoSuchKey: An error occurred (NoSuchKey) when calling the GetObject operation: The specified key does not exist.
127.0.0.1 - - [22/Jul/2021 16:25:07] "GET /s3/ninfo-property-images/000023d448b50c23836ac0ea4e699287aa4ce707.jpg?tags=rekognition HTTP/1.1" 500 -




  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/errorfactory.py", line 51, in __getattr__
    raise AttributeError(
AttributeError: <botocore.errorfactory.S3Exceptions object at 0x7fa3de7521c0> object has no attribute 'EndpointConnectionError'. Valid exceptions are: BucketAlreadyExists, BucketAlreadyOwnedByYou, InvalidObjectState, NoSuchBucket, NoSuchKey, NoSuchUpload, ObjectAlreadyInActiveTierError, ObjectNotInActiveTierError





 * Running on http://127.0.0.1:8880/ (Press CTRL+C to quit)
127.0.0.1 - - [22/Jul/2021 10:28:01] "GET /s3/ninfo-property-images/2eece964b6f902124052810e5a92d6f9ca715c1b.jpg HTTP/1.1" 200 -
[2021-07-22 10:28:45,237] ERROR in app: Exception on /s3/ninfo-property-images/2eece964b6f902124052810e5a92d6f9ca715c1b.jpg [GET]
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connection.py", line 159, in _new_conn
    conn = connection.create_connection(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/util/connection.py", line 61, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/httpsession.py", line 323, in send
    urllib_response = conn.urlopen(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connectionpool.py", line 726, in urlopen
    retries = retries.increment(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/util/retry.py", line 386, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/packages/six.py", line 735, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connectionpool.py", line 670, in urlopen
    httplib_response = self._make_request(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connectionpool.py", line 381, in _make_request
    self._validate_conn(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connectionpool.py", line 978, in _validate_conn
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connection.py", line 309, in connect
    conn = self._new_conn()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/urllib3/connection.py", line 171, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0x7fd678f6ed90>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 2446, in wsgi_app
    response = self.full_dispatch_request()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1951, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1820, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/_compat.py", line 39, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1949, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/flask/app.py", line 1935, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "./s3imglbr.py", line 59, in get_s3bucketobject
    s3_result = s3_client.list_objects_v2(Bucket=s3bucket, Prefix=s3object, Delimiter = "/")
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/client.py", line 386, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/client.py", line 691, in _make_api_call
    http, parsed_response = self._make_request(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/client.py", line 711, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/endpoint.py", line 102, in make_request
    return self._send_request(request_dict, operation_model)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/endpoint.py", line 136, in _send_request
    while self._needs_retry(attempts, operation_model, request_dict,
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/endpoint.py", line 253, in _needs_retry
    responses = self._event_emitter.emit(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/hooks.py", line 356, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/hooks.py", line 228, in emit
    return self._emit(event_name, kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/hooks.py", line 211, in _emit
    response = handler(**kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 183, in __call__
    if self._checker(attempts, response, caught_exception):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 250, in __call__
    should_retry = self._should_retry(attempt_number, response,
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 277, in _should_retry
    return self._checker(attempt_number, response, caught_exception)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 316, in __call__
    checker_response = checker(attempt_number, response,
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 222, in __call__
    return self._check_caught_exception(
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/retryhandler.py", line 359, in _check_caught_exception
    raise caught_exception
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/endpoint.py", line 200, in _do_get_response
    http_response = self._send(request)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/endpoint.py", line 269, in _send
    return self.http_session.send(request)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/botocore/httpsession.py", line 352, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://ninfo-property-images.s3.amazonaws.com/?list-type=2&prefix=2eece964b6f902124052810e5a92d6f9ca715c1b.jpg&delimiter=%2F&encoding-type=url"
127.0.0.1 - - [22/Jul/2021 10:28:45] "GET /s3/ninfo-property-images/2eece964b6f902124052810e5a92d6f9ca715c1b.jpg HTTP/1.1" 500 -










